package cn.cza.springboot.modules.sys.service.impl;import cn.cza.springboot.common.utils.Constant;import cn.cza.springboot.common.utils.Constant.MenuType;import cn.cza.springboot.modules.sys.dao.SysMenuDao;import cn.cza.springboot.modules.sys.pojo.SysMenuEntity;import cn.cza.springboot.modules.sys.service.SysMenuService;import cn.cza.springboot.modules.sys.service.SysUserService;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Service;import java.util.ArrayList;import java.util.List;/** * @Author: 车子昂 * @Date: 2018/12/3 0003 11:15 * @Description: */@Servicepublic class SysMenuServiceImpl implements SysMenuService {    @Autowired    private SysMenuDao sysMenuDao;    @Autowired    private SysUserService sysUserService;    @Override    public List<SysMenuEntity> getUserMenuList(Long userId) {        //系统管理员，拥有最高权限        if(userId == Constant.SUPER_ADMIN){            return getAllMenuList(null);        }        //用户菜单列表        List<Long> menuIdList = sysUserService.queryAllMenuId(userId);        return getAllMenuList(menuIdList);    }    /**     * 获取所有菜单列表     */    private List<SysMenuEntity> getAllMenuList(List<Long> menuIdList){        //查询根菜单列表        List<SysMenuEntity> menuList = queryListParentId(0L, menuIdList);        //		//递归获取子菜单        getMenuTreeList(menuList, menuIdList);        return menuList;    }    /**     * 递归     */    private List<SysMenuEntity> getMenuTreeList(List<SysMenuEntity> menuList, List<Long> menuIdList){        List<SysMenuEntity> subMenuList = new ArrayList<SysMenuEntity>();        for(SysMenuEntity entity : menuList){            if(entity.getType() == MenuType.CATALOG.getValue()){//目录                entity.setList(getMenuTreeList(queryListParentId(entity.getMenuId(), menuIdList), menuIdList));            }            subMenuList.add(entity);        }        return subMenuList;    }    @Override    public List<SysMenuEntity> queryListParentId(Long parentId) {        return sysMenuDao.queryListParentId(parentId);    }    @Override    public List<SysMenuEntity> queryListParentId(Long parentId, List<Long> menuIdList) {        List<SysMenuEntity> menuList = queryListParentId(parentId);        if(menuIdList == null){            return menuList;        }        List<SysMenuEntity> userMenuList = new ArrayList<>();        for(SysMenuEntity menu : menuList){            if(menuIdList.contains(menu.getMenuId())){                userMenuList.add(menu);            }        }        return userMenuList;    }}